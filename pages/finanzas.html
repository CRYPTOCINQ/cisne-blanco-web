<!doctype html> 
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Cisne Blanco ‚Äî Finanzas</title>
  <link rel="icon" href="../assets/favicon.png" type="image/png" />
  <link rel="stylesheet" href="../assets/css/main.css?v=1401.1" />

  <script src="../assets/js/theme.js"></script>
</head>

<body class="transition-theme">


<!-- ========= Topbar ========= -->
<header class="topbar">
  <div class="topbar-inner">
    <a href="../index.html" class="brand">
      <span class="brand-dot">CB</span>
      <span class="brand-title">Cisne Blanco ‚Äî Maqueta Base</span>
    </a>

    <nav class="tabs">
      <a href="../index.html">Inicio</a>
      <a href="./calendario.html">Calendario</a>
      <a href="./habitos.html">H√°bitos</a>
      <a href="./salud.html">Salud</a>
      <a href="./familia.html">Familia</a>
      <a href="./social.html">Social</a>
      <a class="active" href="./finanzas.html">Finanzas</a>
    </nav>

    <button id="themeToggle" class="theme-pill">
      Tema: <span id="themeLabel">auto</span>
    </button>
  </div>
</header>


<main style="max-width:1100px;margin:1.25rem auto;padding:0 1rem;">


  <!-- ========= Panel superior: totales ========= -->
  <section class="surface" style="padding:1rem;">
    <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:.75rem;">
      <div class="card p-3" id="cardSaldo">
        <div class="muted text-sm">üí∞ Saldo total</div>
        <div id="saldoTotal" style="font-size:1.75rem;font-weight:700;margin-top:.25rem;">0</div>
      </div>
      <div class="card p-3">
        <div class="muted text-sm">üü¢ Ingresos</div>
        <div id="totalIngresos" style="font-size:1.5rem;font-weight:700;margin-top:.25rem;">0</div>
      </div>
      <div class="card p-3">
        <div class="muted text-sm">üî¥ Egresos</div>
        <div id="totalEgresos" style="font-size:1.5rem;font-weight:700;margin-top:.25rem;">0</div>
      </div>
    </div>

    <!-- Controles -->
    <div style="display:flex;gap:.5rem;align-items:center;justify-content:space-between;margin-top:.75rem;">
      <div style="display:flex;gap:.5rem;flex-wrap:wrap;">
        <button id="btnAdd" class="btn btn-primary">+ Movimiento</button>
        <button id="btnAddTrade" class="btn btn-sm btn-primary">+ Trade</button>
        <button id="btnExport" class="btn">Exportar (Excel / PDF)</button>
      </div>

      <div style="display:flex;gap:.5rem;align-items:center;flex-wrap:wrap;">
        <select id="filtroCategoria" class="input" style="min-width:160px;">
          <option value="">Todas las categor√≠as</option>
          <option>Forex</option>
          <option>Acciones</option>
          <option>√çndices</option>
          <option>Futuros</option>
          <option>Crypto</option>
          <option>Otros</option>
        </select>
        <input id="filtroDesde" type="date" class="input" />
        <input id="filtroHasta" type="date" class="input" />
        <button id="btnLimpiarFiltros" class="btn btn-sm">Limpiar</button>
      </div>
    </div>
  </section>


  <!-- ========= Lista Movimientos ========= -->
  <section style="margin-top:1rem;">
    <h2 style="margin:0;">Movimientos</h2>
    <div id="listaMovimientos" class="surface" style="margin-top:.5rem;padding:1rem;"></div>
  </section>

  <!-- ========= Gr√°ficos ========= -->
  <section style="margin-top:1rem;">
    <div class="card" style="padding:1rem; display:flex; flex-direction:column; gap:1rem;">

      <!-- ############ BOTONERA MODIFICADA (Torta / Barras / Ambos) -->
      <div style="display:flex; gap:.5rem; flex-wrap:wrap; align-items:center;">
        <button id="tabTorta" class="btn btn-sm btn--primary">Torta</button>
        <button id="tabBarras" class="btn btn-sm">Barras</button>
        <button id="tabAmbos" class="btn btn-sm">Ambos</button>

        <select id="modoGrafico" class="input" style="max-width:130px; margin-left:auto;">
          <option value="dia">D√≠a</option>
          <option value="semana">Semana</option>
          <option value="mes">Mes</option>
        </select>
      </div>

      <!-- ############ CONTENEDOR AJUSTADO PARA DOS GR√ÅFICOS -->
      <div id="chartContainer" style="display:flex; gap:1rem; align-items:flex-start; justify-content:space-between;">
          <canvas id="chartTorta" style="max-height:240px; flex:1;"></canvas>
          <canvas id="chartBarras" style="max-height:240px; flex:1; display:none;"></canvas>
      </div>

    </div>
  </section>


  <!-- ===========================================================
       MODAL TRADING
  =========================================================== -->
  <dialog id="modalTrade" class="card" style="padding:0;">
    <form method="dialog" style="padding:1rem 1rem 0 1rem;">
      <h3 style="margin:0 0 .75rem 0;">Nueva operaci√≥n</h3>

      <div class="modal-grid" style="display:grid;grid-template-columns:repeat(2,1fr);gap:.75rem;">

        <div>
          <label class="muted">Fecha</label>
          <input id="tradeDate" type="date" class="input">
        </div>

        <div>
          <label class="muted">Hora</label>
          <input id="tradeTime" type="time" class="input">
        </div>

        <div>
          <label class="muted">Ticker</label>
          <input id="tradeTicker" type="text" class="input" placeholder="EURUSD / AAPL / BTCUSDT">
        </div>

        <div>
          <label class="muted">Tipo</label>
          <select id="tradeType" class="input">
            <option value="buy">Buy</option>
            <option value="sell">Sell</option>
          </select>
        </div>

        <div>
          <label class="muted">Ticket</label>
          <input id="tradeTicket" type="number" class="input" placeholder="N¬∞">
        </div>

        <div>
          <label class="muted">Entry</label>
          <input id="tradeEntry" type="number" class="input" step="0.0001">
        </div>

        <div>
          <label class="muted">SL</label>
          <input id="tradeSL" type="number" class="input" step="0.0001">
        </div>

        <div>
          <label class="muted">TP</label>
          <input id="tradeTP" type="number" class="input" step="0.0001">
        </div>

        <div>
          <label class="muted">Profit</label>
          <input id="tradeProfit" type="number" class="input" step="0.01" placeholder="0.00">
        </div>

      </div>

      <div class="modal-actions" style="display:flex;gap:.5rem;justify-content:flex-end;padding:1rem 0;">
        <button id="btnSaveTrade" class="btn btn-primary">Guardar</button>
        <button value="cancel" class="btn">Cerrar</button>
      </div>
    </form>
  </dialog>

</main>


<!-- ===========================================================
     TOGGLE TEMA (lo dejamos igual)
=========================================================== -->
<script>
(function () {
  const root = document.documentElement;
  const KEY = 'theme';
  const btn = document.getElementById('themeToggle');
  const lab = document.getElementById('themeLabel');

  function apply(val) {
    if (val === 'navy-ice') {
      root.setAttribute('data-theme', 'navy-ice');
    } else {
      root.removeAttribute('data-theme');
    }
    lab.textContent = val || 'auto';
  }

  const saved = localStorage.getItem(KEY) || 'auto';
  apply(saved);

  btn.onclick = () => {
    const current = localStorage.getItem(KEY) || 'auto';
    const next = current === 'navy-ice' ? 'auto' : 'navy-ice';
    localStorage.setItem(KEY, next);
    apply(next);
  };
})();
</script>

<!-- ========= Librer√≠as externas ========= -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<!-- ========= M√≥dulos Finanzas ========= -->
<script src="./js/finanzas.core.js"></script>
<script src="./js/finanzas.ui.js"></script>
<script src="./js/finanzas.charts.js"></script>
<script src="./js/finanzas.export.js"></script>
<script src="./js/finanzas.modals.js"></script>
<script src="./js/finanzas.main.js"></script>

<style>
  [data-theme="navy-ice"] #chartTorta,
  [data-theme="navy-ice"] #chartBarras {
    filter: brightness(1.35) contrast(1.15);
  }
</style>

</body>
</html>
